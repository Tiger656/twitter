{"version":3,"file":"acl.js","sourceRoot":"","sources":["../../../src/auth/acl.ts"],"names":[],"mappings":";;;AAGa,QAAA,YAAY,GAAG,CAAC,OAAO,EAAE,cAAc,CAAU,CAAC;AAIlD,QAAA,kBAAkB,GAAG;IAChC,aAAa;IACb,eAAe;IACf,aAAa;IACb,uBAAuB;IACvB,aAAa;IACb,uBAAuB;CASf,CAAC;AAQE,QAAA,GAAG,GAAkC;IAChD,KAAK,EAAE;QACL,EAAE,UAAU,EAAE,aAAa,EAAE;QAC7B,EAAE,UAAU,EAAE,eAAe,EAAE;QAC/B,EAAE,UAAU,EAAE,aAAa,EAAE;QAC7B,EAAE,UAAU,EAAE,uBAAuB,EAAE;QACvC,EAAE,UAAU,EAAE,aAAa,EAAE;QAC7B,EAAE,UAAU,EAAE,uBAAuB,EAAE;KAMxC;IACD,YAAY,EAAE;QACZ,EAAE,UAAU,EAAE,aAAa,EAAE;QAC7B,EAAE,UAAU,EAAE,eAAe,EAAE;QAC/B;YACE,UAAU,EAAE,uBAAuB;YACnC,SAAS,EAAE,CAAC,SAAS,EAAE,QAAgB,EAAE,EAAE;gBACzC,OAAO,SAAS,CAAC,GAAG,CAAC,QAAQ,EAAE,KAAK,QAAQ,CAAC;YAC/C,CAAC;SACF;QACD;YACE,UAAU,EAAE,uBAAuB;YACnC,SAAS,EAAE,CAAC,SAAS,EAAE,QAAgB,EAAE,EAAE,CACzC,SAAS,CAAC,GAAG,CAAC,QAAQ,EAAE,KAAK,QAAQ;SACxC;KACF;CACF,CAAC","sourcesContent":["import { JwtPayload } from \"./jwt-payload.dto\";\n\n\nexport const allowedRoles = ['admin', 'regular_user'] as const;\nexport type Role = (typeof allowedRoles)[number];\n\n\nexport const allowedPermissions = [\n  'post-create',\n  'post-read-all',\n  'post-update',\n  'post-update-only-self',\n  'post-delete',\n  'post-delete-only-self',\n  //'create-users',\n  // 'read-users',\n  // 'update-users',\n  // 'delete-users',\n  // 'find-all-users',\n  // 'find-user',\n  // 'delete-posts',\n  // 'update-posts'\n] as const;\nexport type Permission = (typeof allowedPermissions)[number];\n\nexport type ACLEntry = {\n  permission: Permission;\n  condition?: (requestor: JwtPayload, entityId: string) => boolean;\n};\n\nexport const acl: Record<Role, Array<ACLEntry>> = {\n  admin: [\n    { permission: 'post-create' },\n    { permission: 'post-read-all' },\n    { permission: 'post-update' },\n    { permission: 'post-update-only-self' },\n    { permission: 'post-delete' },\n    { permission: 'post-delete-only-self' },\n    // { permission: 'read-users' },\n    // { permission: 'update-users' },\n    // { permission: 'delete-users' },\n    // { permission: 'find-all-users' },\n    // { permission: 'find-user' },\n  ],\n  regular_user: [\n    { permission: 'post-create' },\n    { permission: 'post-read-all' },\n    {\n      permission: 'post-update-only-self',\n      condition: (requestor, entityId: string) => {\n        return requestor._id.toString() === entityId;\n      }\n    },\n    {\n      permission: 'post-delete-only-self',\n      condition: (requestor, entityId: string) =>\n        requestor._id.toString() === entityId,\n    }, // Add user premissions;\n  ],\n};\n"]}